### Floyd

> 适用于任何图，不管有向无向，边权正负，但是最短路必须存在。（不能有个负环）

> 1. 我们定义一个数组 `f[k][x][y]`，表示只允许经过结点 1![1](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) 到 𝑘![k](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)（也就是说，在子图 𝑉′ =1,2,…,𝑘![V'={1, 2, \ldots, k}](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) 中的路径，注意，𝑥![x](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) 与 𝑦![y](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) 不一定在这个子图中），结点 𝑥![x](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) 到结点 𝑦![y](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) 的最短路长度。`f[n][x][y]` 就是结点 𝑥![x](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) 到结点 𝑦![y](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) 的最短路长度。

```python
for k in range(1, n + 1):
    for x in range(1, n + 1):
        for y in range(1, n + 1):
            f[x][y] = min(f[x][y], f[x][k] + f[k][y])
```

```python
#例题：https://www.luogu.com.cn/problem/P2910
def solve():
    n,m = map(int ,input().split())
    a = []
    edges = []
    for _ in range(m):
        x = int(input())
        a.append(x)
    f = [[[0] for _ in range(n + 1)]for i in range(n + 1)]
    for i in range(1,n + 1):
        b = [0] + list(map(int,input().split()))
        for _ in range(1,n + 1):
            f[i][_] = b[_]
    for k in range(1,n + 1):
        for x in range(1,n + 1):
            for y in range(1,n + 1):
                f[x][y] = min(f[x][y] , f[x][k] + f[k][y])
    ans = 0
    for i in range(len(a) - 1):
        x = a[i]
        y = a[i + 1]
        ans += f[x][y]
    print(ans)

if __name__ == '__main__':
    solve()
```

